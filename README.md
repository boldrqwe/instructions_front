# Инструкции — фронтенд ридера

MVP интерфейс для чтения длинных инструкций: публикации со страницей чтения, оглавлением и встроенным поиском по статьям и секциям.

## Возможности
- главная страница со списком опубликованных статей и поиском;
- страница статьи с синхронизированным оглавлением (глава → секция), поддержкой deep-link по якорям и подсветкой текущего раздела;
- поисковая страница с debounce, пагинацией и переходами в конкретные секции статей;
- безопасный рендер markdown с поддержкой таблиц, списков и кода.

## Быстрый старт
```bash
npm install
npm run dev
```
Приложение будет доступно на [http://localhost:5173](http://localhost:5173).

## Скрипты
- `npm run dev` — запуск dev-сервера Vite;
- `npm run build` — типизация (`tsc -b`) и production-сборка;
- `npm run preview` — предпросмотр собранного проекта;
- `npm run test` — юнит- и компонентные тесты (Vitest + Testing Library);
- `npm run lint` — проверка ESLint с Prettier;
- `npm run typecheck` — строгая проверка типов без генерации артефактов.

## Конфигурация
- `VITE_API_BASE_URL` — обязательный префикс API (например, `/api/v1` или полный URL);
- опционально `VITE_APP_BASE_PATH` — base path для развёртывания не из корня домена.

Создайте `.env.local` со значением `VITE_API_BASE_URL`, чтобы фронтенд отправлял запросы в нужный бэкенд.

## SPA-фоллбек (пример Nginx)
```nginx
location / {
  try_files $uri /index.html;
}
```

## Тесты
Ключевые сценарии покрыты Vitest:
- переход по пунктам оглавления, автоподсветка активной секции и работа deep-link;
- обработка 404 для несуществующей статьи;
- безопасность MarkdownView (таблицы, код, фильтрация XSS);
- debounce и пагинация поисковой страницы.

Запуск тестов: `npm run test`.

## Структура проекта
```
src/
  app/                # App-компонент и провайдеры
  pages/              # Страницы роутера
  widgets/            # Составные виджеты (TOC, MarkdownView, SearchBar)
  entities/           # Работа с доменными сущностями и API
  shared/             # Переиспользуемые утилиты, UI и конфиг
```

Глобальные стили и токены находятся в `src/shared/styles` (цвета, шрифты и тени — только через CSS-переменные).

## Admin Editor

Для авторов предусмотрен режим управления статьями:

- приватные роуты `/admin/articles/drafts`, `/admin/articles/new`, `/admin/articles/:id/edit` и предпросмотр `/articles/preview` (только для авторизованных админов);
- полноформатный редактор на базе Tiptap (заголовки h1–h4 с якорями, списки, таблицы, чек-листы, цитаты, код с подсветкой, горизонтальные правила);
- поддержка drag&drop/paste изображений с загрузкой на бэкенд и локальным предпросмотром, управление обложкой статьи;
- автогенерация slug из заголовка, быстрый предпросмотр, публикация/снятие с публикации, авто-сейв с индикатором состояния и предупреждением при закрытии страницы;
- синхронизированное оглавление (ArticleTOC) и адаптивный UI на общих компонентах из `shared/ui`.
